#include <car.h>
#include <speed_control.h>

void auto_ctrl ()
{
    if ((TR10==1 && TR20==0 && TR30==0 && TR40==1) || (TR10==0 && TR20==0 && TR30==0 && TR40==0))   //检测在轨，直行
    {
        straight(100);
    }
    if (TR10==1 && TR20==1 && TR30==0 && TR40==1)   //检测到行驶偏左，向右偏航
    {
        turn_right(20,800);
        if (TR10==1 && TR20==1 && TR30==1 && TR40==1)   //防抖
        {
            straight(100);
        }
    }
    if (TR10==1 && TR20==0 && TR30==1 && TR40==1)   //检测到行驶偏右，向左偏航
    {
        turn_left(20,800);
        if (TR10==1 && TR20==1 && TR30==1 && TR40==1)   //防抖
        {
            straight(100);
        }
    }
    if ((TR10==0 && TR20==1 && TR30==1 && TR40==1) || (TR10==0 && TR20==0 && TR30==1 && TR40==1) || (TR10==0 && TR20==0 && TR30==0 && TR40==1) || (TR10==0 && TR20==1 && TR30==0 && TR40==1))   //检测到轨道较大角度左转，小车左转(如有必要，此处可拆分为多个判断条件，对应多种转向方法)
    {
        turn_left(50,1000);
    }
    if ((TR10==1 && TR20==1 && TR30==1 && TR40==0) || (TR10==1 && TR20==1 && TR30==0 && TR40==0) || (TR10==1 && TR20==0 && TR30==0 && TR40==0) || (TR10==1 && TR20==0 && TR30==1 && TR40==0))   //检测到轨道较大角度右转，小车右转(如有必要，此处可拆分为多个判断条件，对应多种转向方法)
    {
        turn_right(50,1000);
    }
    if (ST0==0)   //检测到障碍物，绕开
    {
        turn_left(25,1000);
    }
}